<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/svg+xml" sizes="any" href="../_static/logo-symbol-only.svg">
    <link rel="icon" type="image/svg+xml" sizes="16x16 24x24 32x32 48x48" href="../_static/favicon.svg"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Configuring setuptools using setup.cfg files" href="declarative_config.html" /><link rel="prev" title="Controlling files in the distribution" href="miscellaneous.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.08.19 -->
        <title>Extending or Customizing Setuptools - setuptools 68.1.2.post20230823 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />




<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #336790;
  --color-brand-content: #336790;

  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #E5B62F;
  --color-brand-content: #E5B62F;

    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #E5B62F;
  --color-brand-content: #E5B62F;

      }
    }
  }
</style></head>
  <body>

    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">setuptools 68.1.2.post20230823 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">

      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">

  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.svg" alt="Logo"/>
  </div>


</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/pypa/setuptools">Home</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/setuptools">PyPI</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">User guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of User guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_discovery.html">Package Discovery and Namespace Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="dependency_management.html">Dependencies Management in Setuptools</a></li>
<li class="toctree-l2"><a class="reference internal" href="development_mode.html">Development Mode (a.k.a. “Editable Installs”)</a></li>
<li class="toctree-l2"><a class="reference internal" href="entry_point.html">Entry Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="datafiles.html">Data Files Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="ext_modules.html">Building Extension Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="distribution.html">Specifying Your Project’s Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html">Controlling files in the distribution</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Extending or Customizing Setuptools</a></li>
<li class="toctree-l2"><a class="reference internal" href="declarative_config.html">Configuring setuptools using <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> files</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyproject_config.html">Configuring setuptools using <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../build_meta.html">Build System Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pkg_resources.html">Package Discovery and Resource Access using <code class="docutils literal notranslate"><span class="pre">pkg_resources</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/keywords.html">Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setuptools.html">Building and Distributing Packages with Setuptools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../development/index.html">Development guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Development guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/developer-guide.html">Developer’s Guide for Setuptools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/releases.html">Release Process</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deprecated/index.html">Backward compatibility &amp; deprecated practice</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Backward compatibility &amp; deprecated practice</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../deprecated/changed_keywords.html">New and Changed <code class="docutils literal notranslate"><span class="pre">setup()</span></code> Keywords</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated/dependency_links.html">Specifying dependencies that aren’t in PyPI via <code class="docutils literal notranslate"><span class="pre">dependency_links</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated/python_eggs.html">The Internal Structure of Python Eggs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated/easy_install.html">Easy Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated/zip_safe.html">Understanding the <code class="docutils literal notranslate"><span class="pre">zip_safe</span></code> flag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated/resource_extraction.html">Automatic Resource Extraction</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../deprecated/distutils/index.html">Distributing Python Modules (Legacy version)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Distributing Python Modules (Legacy version)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../deprecated/distutils/introduction.html">1. An Introduction to Distutils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deprecated/distutils/setupscript.html">2. Writing the Setup Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deprecated/distutils/configfile.html">3. Writing the Setup Configuration File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deprecated/distutils/sourcedist.html">4. Creating a Source Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deprecated/distutils/builtdist.html">5. Creating Built Distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deprecated/distutils/examples.html">6. Distutils Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deprecated/distutils/extending.html">7. Extending Distutils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deprecated/distutils/commandref.html">8. Command Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deprecated/distutils/apiref.html">9. API Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated/distutils-legacy.html">Porting from Distutils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated/functionalities.html">“Eggsecutable” Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deprecated/commands.html">Running <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html#credits">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../artwork.html">Artwork</a></li>
</ul>

</div>
</div>

      </div>

    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="extending-or-customizing-setuptools">
<span id="creating-distutils-extensions"></span><h1>Extending or Customizing Setuptools<a class="headerlink" href="#extending-or-customizing-setuptools" title="Permalink to this heading">#</a></h1>
<p>Setuptools design is based on the <a class="reference external" href="https://docs.python.org/3.9/library/distutils.html">distutils</a> package originally distributed
as part of Python’s standard library, effectively serving as its successor
(as established in <span class="target" id="index-0"></span><a class="pep reference external" href="https://peps.python.org/pep-0632/"><strong>PEP 632</strong></a>).</p>
<p>This means that <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> strives to honor the extension mechanisms
provided by <code class="docutils literal notranslate"><span class="pre">distutils</span></code>, and allows developers to create third party packages
that modify or augment the build process behavior.</p>
<p>A simple way of doing that is to hook in new or existing
commands and <code class="docutils literal notranslate"><span class="pre">setup()</span></code> arguments just by defining “entry points”.  These
are mappings from command or argument names to a specification of where to
import a handler from.  (See the section on <a class="hxr-hoverxref hxr-tooltip reference internal" href="entry_point.html#dynamic-discovery-of-services-and-plugins"><span class="std std-ref">Advertising Behavior</span></a> for some more background on entry points).</p>
<p>The following sections describe the most common procedures for extending
the <code class="docutils literal notranslate"><span class="pre">distutils</span></code> functionality used by <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Any entry-point defined in your <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code>, <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> or
<code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> files are not immediately available for use.  Your
package needs to be installed first, then <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> will be able to
access these entry points.  For example consider a <code class="docutils literal notranslate"><span class="pre">Project-A</span></code> that
defines entry points. When building <code class="docutils literal notranslate"><span class="pre">Project-A</span></code>, these will not be
available.  If <code class="docutils literal notranslate"><span class="pre">Project-B</span></code> declares a <a class="reference internal" href="dependency_management.html"><span class="doc">build system requirement</span></a> on <code class="docutils literal notranslate"><span class="pre">Project-A</span></code>, then <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>
will be able to use <code class="docutils literal notranslate"><span class="pre">Project-A</span></code>’ customizations.</p>
</div>
<section id="customizing-commands">
<h2>Customizing Commands<a class="headerlink" href="#customizing-commands" title="Permalink to this heading">#</a></h2>
<p>Both <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> and <code class="docutils literal notranslate"><span class="pre">distutils</span></code> are structured around the <em>command design
pattern</em>. This means that each main action executed when building a
distribution package (such as creating a <a class="hxr-hoverxref hxr-tooltip reference external" href="https://packaging.python.org/en/latest/glossary/#term-Source-Distribution-or-sdist" title="(in Python Packaging User Guide)"><span class="xref std std-term">sdist</span></a>
or <a class="reference external" href="https://packaging.python.org/en/latest/glossary/#term-Wheel" title="(in Python Packaging User Guide)"><span class="xref std std-term">wheel</span></a>) correspond to the implementation of a Python class.</p>
<p>Originally in <code class="docutils literal notranslate"><span class="pre">distutils</span></code>, these commands would correspond to actual CLI
arguments that could be passed to the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> script to trigger a
different aspect of the build. In <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, however, these command
objects are just a design abstraction that encapsulate logic and help to
organise the code.</p>
<p>You can overwrite existing commands (or add new ones) by defining entry
points in the <code class="docutils literal notranslate"><span class="pre">distutils.commands</span></code> group.  For example, if you wanted to add
a <code class="docutils literal notranslate"><span class="pre">foo</span></code> command, you might add something like this to your project:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup.cfg</span>
<span class="na">...</span>
<span class="k">[options.entry_points]</span>
<span class="na">distutils.commands</span><span class="w"> </span><span class="o">=</span>
<span class="w">     </span><span class="na">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">mypackage.some_module:foo</span>
</pre></div>
</div>
<p>Assuming, of course, that the <code class="docutils literal notranslate"><span class="pre">foo</span></code> class in <code class="docutils literal notranslate"><span class="pre">mypackage.some_module</span></code> is
a <code class="docutils literal notranslate"><span class="pre">setuptools.Command</span></code> subclass (documented below).</p>
<p>Once a project containing such entry points has been activated on <code class="docutils literal notranslate"><span class="pre">sys.path</span></code>,
(e.g. by running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code>) the command(s) will be available to any
<code class="docutils literal notranslate"><span class="pre">setuptools</span></code>-based project. In fact, this is
how setuptools’ own commands are installed: the setuptools project’s setup
script defines entry points for them!</p>
<p>The commands <code class="docutils literal notranslate"><span class="pre">sdist</span></code>, <code class="docutils literal notranslate"><span class="pre">build_py</span></code> and <code class="docutils literal notranslate"><span class="pre">build_ext</span></code> are especially useful
to customize <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> builds. Note however that when overwriting existing
commands, you should be very careful to maintain API compatibility.
Custom commands should try to replicate the same overall behavior as the
original classes, and when possible, even inherit from them.</p>
<p>You should also consider handling exceptions such as <code class="docutils literal notranslate"><span class="pre">CompileError</span></code>,
<code class="docutils literal notranslate"><span class="pre">LinkError</span></code>, <code class="docutils literal notranslate"><span class="pre">LibError</span></code>, among others. These exceptions are available in
the <code class="docutils literal notranslate"><span class="pre">setuptools.errors</span></code> module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="setuptools.Command">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">setuptools.</span></span><span class="sig-name descname"><span class="pre">Command</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#setuptools.Command" title="Permalink to this definition">#</a></dt>
<dd><p>Setuptools internal actions are organized using a <em>command design pattern</em>.
This means that each action (or group of closely related actions) executed during
the build should be implemented as a <code class="docutils literal notranslate"><span class="pre">Command</span></code> subclass.</p>
<p>These commands are abstractions and do not necessarily correspond to a command that
can (or should) be executed via a terminal, in a CLI fashion (although historically
they would).</p>
<p>When creating a new command from scratch, custom defined classes <strong>SHOULD</strong> inherit
from <code class="docutils literal notranslate"><span class="pre">setuptools.Command</span></code> and implement a few mandatory methods.
Between these mandatory methods, are listed:</p>
<dl class="py method">
<dt class="sig sig-object py" id="setuptools.Command.initialize_options">
<span class="sig-name descname"><span class="pre">initialize_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#setuptools.Command.initialize_options" title="Permalink to this definition">#</a></dt>
<dd><p>Set or (reset) all options/attributes/caches used by the command
to their default values. Note that these values may be overwritten during
the build.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="setuptools.Command.finalize_options">
<span class="sig-name descname"><span class="pre">finalize_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#setuptools.Command.finalize_options" title="Permalink to this definition">#</a></dt>
<dd><p>Set final values for all options/attributes used by the command.
Most of the time, each option/attribute/cache should only be set if it does not
have any value yet (e.g. <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">self.attr</span> <span class="pre">is</span> <span class="pre">None:</span> <span class="pre">self.attr</span> <span class="pre">=</span> <span class="pre">val</span></code>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="setuptools.Command.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#setuptools.Command.run" title="Permalink to this definition">#</a></dt>
<dd><p>Execute the actions intended by the command.
(Side effects <strong>SHOULD</strong> only take place when <code class="docutils literal notranslate"><span class="pre">run</span></code> is executed,
for example, creating new files or writing to the terminal output).</p>
</dd></dl>

<p>A useful analogy for command classes is to think of them as subroutines with local
variables called “options”.  The options are “declared” in <code class="docutils literal notranslate"><span class="pre">initialize_options()</span></code>
and “defined” (given their final values, aka “finalized”) in <code class="docutils literal notranslate"><span class="pre">finalize_options()</span></code>,
both of which must be defined by every command class. The “body” of the subroutine,
(where it does all the work) is the <code class="docutils literal notranslate"><span class="pre">run()</span></code> method.
Between <code class="docutils literal notranslate"><span class="pre">initialize_options()</span></code> and <code class="docutils literal notranslate"><span class="pre">finalize_options()</span></code>, <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> may set
the values for options/attributes based on user’s input (or circumstance),
which means that the implementation should be careful to not overwrite values in
<code class="docutils literal notranslate"><span class="pre">finalize_options</span></code> unless necessary.</p>
<p>Please note that other commands (or other parts of setuptools) may also overwrite
the values of the command’s options/attributes multiple times during the build
process.
Therefore it is important to consistently implement <code class="docutils literal notranslate"><span class="pre">initialize_options()</span></code> and
<code class="docutils literal notranslate"><span class="pre">finalize_options()</span></code>. For example, all derived attributes (or attributes that
depend on the value of other attributes) <strong>SHOULD</strong> be recomputed in
<code class="docutils literal notranslate"><span class="pre">finalize_options</span></code>.</p>
<p>When overwriting existing commands, custom defined classes <strong>MUST</strong> abide by the
same APIs implemented by the original class. They also <strong>SHOULD</strong> inherit from the
original class.</p>
</dd></dl>

<section id="supporting-sdists-and-editable-installs-in-build-sub-commands">
<h3>Supporting sdists and editable installs in <code class="docutils literal notranslate"><span class="pre">build</span></code> sub-commands<a class="headerlink" href="#supporting-sdists-and-editable-installs-in-build-sub-commands" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">build</span></code> sub-commands (like <code class="docutils literal notranslate"><span class="pre">build_py</span></code> and <code class="docutils literal notranslate"><span class="pre">build_ext</span></code>)
are encouraged to implement the following protocol:</p>
<dl class="py class">
<dt class="sig sig-object py" id="setuptools.command.build.SubCommand">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">setuptools.command.build.</span></span><span class="sig-name descname"><span class="pre">SubCommand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#setuptools.command.build.SubCommand" title="Permalink to this definition">#</a></dt>
<dd><p>In order to support editable installations (see <span class="target" id="index-1"></span><a class="pep reference external" href="https://peps.python.org/pep-0660/"><strong>PEP 660</strong></a>) all
build subcommands <strong>SHOULD</strong> implement this protocol. They also <strong>MUST</strong> inherit
from <code class="docutils literal notranslate"><span class="pre">setuptools.Command</span></code>.</p>
<p>When creating an <span class="target" id="index-2"></span><a class="pep reference external" href="https://peps.python.org/pep-0660/"><strong>editable wheel</strong></a>, <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> will try to evaluate
custom <code class="docutils literal notranslate"><span class="pre">build</span></code> subcommands using the following procedure:</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">setuptools</span></code> will set the <code class="docutils literal notranslate"><span class="pre">editable_mode</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">setuptools</span></code> will execute the <code class="docutils literal notranslate"><span class="pre">run()</span></code> command.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Subcommands <strong>SHOULD</strong> take advantage of <code class="docutils literal notranslate"><span class="pre">editable_mode=True</span></code> to adequate
its behaviour or perform optimisations.</p>
<p>For example, if a subcommand doesn’t need to generate an extra file and
all it does is to copy a source file into the build directory,
<code class="docutils literal notranslate"><span class="pre">run()</span></code> <strong>SHOULD</strong> simply “early return”.</p>
<p>Similarly, if the subcommand creates files that would be placed alongside
Python files in the final distribution, during an editable install
the command <strong>SHOULD</strong> generate these files “in place” (i.e. write them to
the original source directory, instead of using the build directory).
Note that <code class="docutils literal notranslate"><span class="pre">get_output_mapping()</span></code> should reflect that and include mappings
for “in place” builds accordingly.</p>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">setuptools</span></code> use any knowledge it can derive from the return values of
<code class="docutils literal notranslate"><span class="pre">get_outputs()</span></code> and <code class="docutils literal notranslate"><span class="pre">get_output_mapping()</span></code> to create an editable wheel.
When relevant <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> <strong>MAY</strong> attempt to use file links based on the value
of <code class="docutils literal notranslate"><span class="pre">get_output_mapping()</span></code>. Alternatively, <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> <strong>MAY</strong> attempt to use
<a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/reference/import.html" title="(in Python v3.11)"><span class="xref std std-doc">import hooks</span></a> to redirect any attempt to import
to the directory with the original source code and other files built in place.</p></li>
</ol>
<p>Please note that custom sub-commands <strong>SHOULD NOT</strong> rely on <code class="docutils literal notranslate"><span class="pre">run()</span></code> being
executed (or not) to provide correct return values for <code class="docutils literal notranslate"><span class="pre">get_outputs()</span></code>,
<code class="docutils literal notranslate"><span class="pre">get_output_mapping()</span></code> or <code class="docutils literal notranslate"><span class="pre">get_source_files()</span></code>. The <code class="docutils literal notranslate"><span class="pre">get_*</span></code> methods should
work independently of <code class="docutils literal notranslate"><span class="pre">run()</span></code>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="setuptools.command.build.SubCommand.build_lib">
<span class="sig-name descname"><span class="pre">build_lib</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></em><a class="headerlink" href="#setuptools.command.build.SubCommand.build_lib" title="Permalink to this definition">#</a></dt>
<dd><p>String representing the directory where the build artifacts should be stored,
e.g. <code class="docutils literal notranslate"><span class="pre">build/lib</span></code>.
For example, if a distribution wants to provide a Python module named <code class="docutils literal notranslate"><span class="pre">pkg.mod</span></code>,
then a corresponding file should be written to <code class="docutils literal notranslate"><span class="pre">{build_lib}/package/module.py</span></code>.
A way of thinking about this is that the files saved under <code class="docutils literal notranslate"><span class="pre">build_lib</span></code>
would be eventually copied to one of the directories in <a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/site.html#site.PREFIXES" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">site.PREFIXES</span></code></a>
upon installation.</p>
<p>A command that produces platform-independent files (e.g. compiling text templates
into Python functions), <strong>CAN</strong> initialize <code class="docutils literal notranslate"><span class="pre">build_lib</span></code> by copying its value from
the <code class="docutils literal notranslate"><span class="pre">build_py</span></code> command. On the other hand, a command that produces
platform-specific files <strong>CAN</strong> initialize <code class="docutils literal notranslate"><span class="pre">build_lib</span></code> by copying its value from
the <code class="docutils literal notranslate"><span class="pre">build_ext</span></code> command. In general this is done inside the <code class="docutils literal notranslate"><span class="pre">finalize_options</span></code>
method with the help of the <code class="docutils literal notranslate"><span class="pre">set_undefined_options</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">finalize_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_undefined_options</span><span class="p">(</span><span class="s2">&quot;build_py&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;build_lib&quot;</span><span class="p">,</span> <span class="s2">&quot;build_lib&quot;</span><span class="p">))</span>
    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="setuptools.command.build.SubCommand.editable_mode">
<span class="sig-name descname"><span class="pre">editable_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#setuptools.command.build.SubCommand.editable_mode" title="Permalink to this definition">#</a></dt>
<dd><p>Boolean flag that will be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> when setuptools is used for an
editable installation (see <span class="target" id="index-3"></span><a class="pep reference external" href="https://peps.python.org/pep-0660/"><strong>PEP 660</strong></a>).
Implementations <strong>SHOULD</strong> explicitly set the default value of this attribute to
<code class="docutils literal notranslate"><span class="pre">False</span></code>.
When subcommands run, they can use this flag to perform optimizations or change
their behaviour accordingly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="setuptools.command.build.SubCommand.finalize_options">
<span class="sig-name descname"><span class="pre">finalize_options</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#setuptools.command.build.SubCommand.finalize_options" title="Permalink to this definition">#</a></dt>
<dd><p>(Required by the original <a class="reference internal" href="#setuptools.Command" title="setuptools.Command"><code class="xref py py-class docutils literal notranslate"><span class="pre">setuptools.Command</span></code></a> interface)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="setuptools.command.build.SubCommand.get_output_mapping">
<span class="sig-name descname"><span class="pre">get_output_mapping</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#setuptools.command.build.SubCommand.get_output_mapping" title="Permalink to this definition">#</a></dt>
<dd><p>Return a mapping between destination files as they would be produced by the
build (dict keys) into the respective existing (source) files (dict values).
Existing (source) files should be represented as strings relative to the project
root directory.
Destination files should be strings in the form of
<code class="docutils literal notranslate"><span class="pre">&quot;{build_lib}/destination/file/path&quot;</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="setuptools.command.build.SubCommand.get_outputs">
<span class="sig-name descname"><span class="pre">get_outputs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#setuptools.command.build.SubCommand.get_outputs" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of files intended for distribution as they would have been
produced by the build.
These files should be strings in the form of
<code class="docutils literal notranslate"><span class="pre">&quot;{build_lib}/destination/file/path&quot;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The return value of <code class="docutils literal notranslate"><span class="pre">get_output()</span></code> should include all files used as keys
in <code class="docutils literal notranslate"><span class="pre">get_output_mapping()</span></code> plus files that are generated during the build
and don’t correspond to any source file already present in the project.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="setuptools.command.build.SubCommand.get_source_files">
<span class="sig-name descname"><span class="pre">get_source_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#setuptools.command.build.SubCommand.get_source_files" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of all files that are used by the command to create the expected
outputs.
For example, if your build command transpiles Java files into Python, you should
list here all the Java files.
The primary purpose of this function is to help populating the <code class="docutils literal notranslate"><span class="pre">sdist</span></code>
with all the files necessary to build the distribution.
All files should be strings relative to the project root directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="setuptools.command.build.SubCommand.initialize_options">
<span class="sig-name descname"><span class="pre">initialize_options</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#setuptools.command.build.SubCommand.initialize_options" title="Permalink to this definition">#</a></dt>
<dd><p>(Required by the original <a class="reference internal" href="#setuptools.Command" title="setuptools.Command"><code class="xref py py-class docutils literal notranslate"><span class="pre">setuptools.Command</span></code></a> interface)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="setuptools.command.build.SubCommand.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#setuptools.command.build.SubCommand.run" title="Permalink to this definition">#</a></dt>
<dd><p>(Required by the original <a class="reference internal" href="#setuptools.Command" title="setuptools.Command"><code class="xref py py-class docutils literal notranslate"><span class="pre">setuptools.Command</span></code></a> interface)</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="adding-arguments">
<h2>Adding Arguments<a class="headerlink" href="#adding-arguments" title="Permalink to this heading">#</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Adding arguments to setup is discouraged as such arguments
are only supported through imperative execution and not supported through
declarative config.</p>
</div>
<p>Sometimes, your commands may need additional arguments to the <code class="docutils literal notranslate"><span class="pre">setup()</span></code>
call.  You can enable this by defining entry points in the
<code class="docutils literal notranslate"><span class="pre">distutils.setup_keywords</span></code> group.  For example, if you wanted a <code class="docutils literal notranslate"><span class="pre">setup()</span></code>
argument called <code class="docutils literal notranslate"><span class="pre">bar_baz</span></code>, you might add something like this to your
extension project:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup.cfg</span>
<span class="na">...</span>
<span class="k">[options.entry_points]</span>
<span class="na">distutils.commands</span><span class="w"> </span><span class="o">=</span>
<span class="w">     </span><span class="na">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">mypackage.some_module:foo</span>
<span class="na">distutils.setup_keywords</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">bar_baz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">mypackage.some_module:validate_bar_baz</span>
</pre></div>
</div>
<p>The idea here is that the entry point defines a function that will be called
to validate the <code class="docutils literal notranslate"><span class="pre">setup()</span></code> argument, if it’s supplied.  The <code class="docutils literal notranslate"><span class="pre">Distribution</span></code>
object will have the initial value of the attribute set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, and the
validation function will only be called if the <code class="docutils literal notranslate"><span class="pre">setup()</span></code> call sets it to
a non-<code class="docutils literal notranslate"><span class="pre">None</span></code> value.  Here’s an example validation function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">assert_bool</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify that value is True, False, 0, or 1&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">SetupError</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> must be a boolean value (got </span><span class="si">%r</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attr</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Your function should accept three arguments: the <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> object,
the attribute name, and the attribute value.  It should raise a
<code class="docutils literal notranslate"><span class="pre">SetupError</span></code> (from the <code class="docutils literal notranslate"><span class="pre">setuptools.errors</span></code> module) if the argument
is invalid.  Remember, your function will only be called with non-<code class="docutils literal notranslate"><span class="pre">None</span></code> values,
and the default value of arguments defined this way is always <code class="docutils literal notranslate"><span class="pre">None</span></code>.  So, your
commands should always be prepared for the possibility that the attribute will
be <code class="docutils literal notranslate"><span class="pre">None</span></code> when they access it later.</p>
<p>If more than one active distribution defines an entry point for the same
<code class="docutils literal notranslate"><span class="pre">setup()</span></code> argument, <em>all</em> of them will be called.  This allows multiple
extensions to define a common argument, as long as they agree on
what values of that argument are valid.</p>
</section>
<section id="customizing-distribution-options">
<h2>Customizing Distribution Options<a class="headerlink" href="#customizing-distribution-options" title="Permalink to this heading">#</a></h2>
<p>Plugins may wish to extend or alter the options on a <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> object to
suit the purposes of that project. For example, a tool that infers the
<code class="docutils literal notranslate"><span class="pre">Distribution.version</span></code> from SCM-metadata may need to hook into the
option finalization. To enable this feature, Setuptools offers an entry
point <code class="docutils literal notranslate"><span class="pre">setuptools.finalize_distribution_options</span></code>. That entry point must
be a callable taking one argument (the <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> instance).</p>
<p>If the callable has an <code class="docutils literal notranslate"><span class="pre">.order</span></code> property, that value will be used to
determine the order in which the hook is called. Lower numbers are called
first and the default is zero (0).</p>
<p>Plugins may read, alter, and set properties on the distribution, but each
plugin is encouraged to load the configuration/settings for their behavior
independently.</p>
</section>
<section id="defining-additional-metadata">
<h2>Defining Additional Metadata<a class="headerlink" href="#defining-additional-metadata" title="Permalink to this heading">#</a></h2>
<p>Some extensible applications and frameworks may need to define their own kinds
of metadata, which they can then access using the <a class="hxr-hoverxref hxr-tooltip reference external" href="https://docs.python.org/3/library/importlib.metadata.html#module-importlib.metadata" title="(in Python v3.11)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.metadata</span></code></a> APIs.
Ordinarily, this is done by having plugin
developers include additional files in their <code class="docutils literal notranslate"><span class="pre">ProjectName.egg-info</span></code>
directory.  However, since it can be tedious to create such files by hand, you
may want to create an extension that will create the necessary files
from arguments to <code class="docutils literal notranslate"><span class="pre">setup()</span></code>, in much the same way that <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> does
for many of the <code class="docutils literal notranslate"><span class="pre">setup()</span></code> arguments it adds.  See the section below for more
details.</p>
<section id="adding-new-egg-info-files">
<span id="id1"></span><h3>Adding new EGG-INFO Files<a class="headerlink" href="#adding-new-egg-info-files" title="Permalink to this heading">#</a></h3>
<p>Some extensible applications or frameworks may want to allow third parties to
develop plugins with application or framework-specific metadata included in
the plugins’ EGG-INFO directory, for easy access via the <code class="docutils literal notranslate"><span class="pre">pkg_resources</span></code>
metadata API.  The easiest way to allow this is to create an extension
to be used from the plugin projects’ setup scripts (via <code class="docutils literal notranslate"><span class="pre">setup_requires</span></code>)
that defines a new setup keyword, and then uses that data to write an EGG-INFO
file when the <code class="docutils literal notranslate"><span class="pre">egg_info</span></code> command is run.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">egg_info</span></code> command looks for extension points in an <code class="docutils literal notranslate"><span class="pre">egg_info.writers</span></code>
group, and calls them to write the files.  Here’s a simple example of an
extension defining a setup argument <code class="docutils literal notranslate"><span class="pre">foo_bar</span></code>, which is a list of
lines that will be written to <code class="docutils literal notranslate"><span class="pre">foo_bar.txt</span></code> in the EGG-INFO directory of any
project that uses the argument:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup.cfg</span>
<span class="na">...</span>
<span class="k">[options.entry_points]</span>
<span class="na">distutils.setup_keywords</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">foo_bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">setuptools.dist:assert_string_list</span>
<span class="na">egg_info.writers</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">foo_bar.txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">setuptools.command.egg_info:write_arg</span>
</pre></div>
</div>
<p>This simple example makes use of two utility functions defined by setuptools
for its own use: a routine to validate that a setup keyword is a sequence of
strings, and another one that looks up a setup argument and writes it to
a file.  Here’s what the writer utility looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">write_arg</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">argname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">basename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">argname</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">cmd</span><span class="o">.</span><span class="n">write_or_delete_file</span><span class="p">(</span><span class="n">argname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see, <code class="docutils literal notranslate"><span class="pre">egg_info.writers</span></code> entry points must be a function taking
three arguments: a <code class="docutils literal notranslate"><span class="pre">egg_info</span></code> command instance, the basename of the file to
write (e.g. <code class="docutils literal notranslate"><span class="pre">foo_bar.txt</span></code>), and the actual full filename that should be
written to.</p>
<p>In general, writer functions should honor the command object’s <code class="docutils literal notranslate"><span class="pre">dry_run</span></code>
setting when writing files, and use <code class="docutils literal notranslate"><span class="pre">logging</span></code> to do any console output.
The easiest way to conform to this requirement is to use
the <code class="docutils literal notranslate"><span class="pre">cmd</span></code> object’s <code class="docutils literal notranslate"><span class="pre">write_file()</span></code>, <code class="docutils literal notranslate"><span class="pre">delete_file()</span></code>, and
<code class="docutils literal notranslate"><span class="pre">write_or_delete_file()</span></code> methods exclusively for your file operations.
See those methods’ docstrings for more details.</p>
</section>
</section>
<section id="adding-support-for-revision-control-systems">
<span id="id2"></span><h2>Adding Support for Revision Control Systems<a class="headerlink" href="#adding-support-for-revision-control-systems" title="Permalink to this heading">#</a></h2>
<p>If the files you want to include in the source distribution are tracked using
Git, Mercurial or SVN, you can use the following packages to achieve that:</p>
<ul class="simple">
<li><p>Git and Mercurial: <a class="reference external" href="https://pypi.org/project/setuptools_scm">setuptools_scm</a></p></li>
<li><p>SVN: <a class="reference external" href="https://pypi.org/project/setuptools_svn">setuptools_svn</a></p></li>
</ul>
<p>If you would like to create a plugin for <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> to find files tracked
by another revision control system, you can do so by adding an entry point to
the <code class="docutils literal notranslate"><span class="pre">setuptools.file_finders</span></code> group.  The entry point should be a function
accepting a single directory name, and should yield all the filenames within
that directory (and any subdirectories thereof) that are under revision
control.</p>
<p>For example, if you were going to create a plugin for a revision control system
called “foobar”, you would write a function something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_files_for_foobar</span><span class="p">(</span><span class="n">dirname</span><span class="p">):</span>
    <span class="o">...</span>  <span class="c1"># loop to yield paths that start with `dirname`</span>
</pre></div>
</div>
<p>And you would register it in a setup script using something like this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup.cfg</span>
<span class="na">...</span>

<span class="k">[options.entry_points]</span>
<span class="na">setuptools.file_finders</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">foobar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">my_foobar_module:find_files_for_foobar</span>
</pre></div>
</div>
<p>Then, anyone who wants to use your plugin can simply install it, and their
local setuptools installation will be able to find the necessary files.</p>
<p>It is not necessary to distribute source control plugins with projects that
simply use the other source control system, or to specify the plugins in
<code class="docutils literal notranslate"><span class="pre">setup_requires</span></code>.  When you create a source distribution with the <code class="docutils literal notranslate"><span class="pre">sdist</span></code>
command, setuptools automatically records what files were found in the
<code class="docutils literal notranslate"><span class="pre">SOURCES.txt</span></code> file.  That way, recipients of source distributions don’t need
to have revision control at all.  However, if someone is working on a package
by checking out with that system, they will need the same plugin(s) that the
original author is using.</p>
<p>A few important points for writing revision control file finders:</p>
<ul class="simple">
<li><p>Your finder function MUST return relative paths, created by appending to the
passed-in directory name.  Absolute paths are NOT allowed, nor are relative
paths that reference a parent directory of the passed-in directory.</p></li>
<li><p>Your finder function MUST accept an empty string as the directory name,
meaning the current directory.  You MUST NOT convert this to a dot; just
yield relative paths.  So, yielding a subdirectory named <code class="docutils literal notranslate"><span class="pre">some/dir</span></code> under
the current directory should NOT be rendered as <code class="docutils literal notranslate"><span class="pre">./some/dir</span></code> or
<code class="docutils literal notranslate"><span class="pre">/somewhere/some/dir</span></code>, but <em>always</em> as simply <code class="docutils literal notranslate"><span class="pre">some/dir</span></code></p></li>
<li><p>Your finder function SHOULD NOT raise any errors, and SHOULD deal gracefully
with the absence of needed programs (i.e., ones belonging to the revision
control system itself.  It <em>may</em>, however, use <code class="docutils literal notranslate"><span class="pre">logging.warning()</span></code> to
inform the user of the missing program(s).</p></li>
</ul>
</section>
<section id="final-remarks">
<h2>Final Remarks<a class="headerlink" href="#final-remarks" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>To use a <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> plugin, your users will need to add your package as a
build requirement to their build-system configuration. Please check out our
guides on <a class="reference internal" href="dependency_management.html"><span class="doc">Dependencies Management in Setuptools</span></a> for more information.</p></li>
<li><p>Directly calling <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">...</span></code> is considered a <strong>deprecated</strong> practice.
You should not add new commands to <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> expecting them to be run
via this interface.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>

        <div class="related-pages">
          <a class="next-page" href="declarative_config.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Configuring setuptools using <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> files</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="miscellaneous.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>

                <div class="title">Controlling files in the distribution</div>

              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Python Packaging Authority
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s

            <a href="https://github.com/pradyunsg/furo">Furo</a>

          </div>
          <div class="right-details">

          </div>
        </div>

      </footer>
    </div>
    <aside class="toc-drawer">


      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Extending or Customizing Setuptools</a><ul>
<li><a class="reference internal" href="#customizing-commands">Customizing Commands</a><ul>
<li><a class="reference internal" href="#setuptools.Command"><code class="docutils literal notranslate"><span class="pre">Command</span></code></a><ul>
<li><a class="reference internal" href="#setuptools.Command.initialize_options"><code class="docutils literal notranslate"><span class="pre">Command.initialize_options()</span></code></a></li>
<li><a class="reference internal" href="#setuptools.Command.finalize_options"><code class="docutils literal notranslate"><span class="pre">Command.finalize_options()</span></code></a></li>
<li><a class="reference internal" href="#setuptools.Command.run"><code class="docutils literal notranslate"><span class="pre">Command.run()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#supporting-sdists-and-editable-installs-in-build-sub-commands">Supporting sdists and editable installs in <code class="docutils literal notranslate"><span class="pre">build</span></code> sub-commands</a><ul>
<li><a class="reference internal" href="#setuptools.command.build.SubCommand"><code class="docutils literal notranslate"><span class="pre">SubCommand</span></code></a><ul>
<li><a class="reference internal" href="#setuptools.command.build.SubCommand.build_lib"><code class="docutils literal notranslate"><span class="pre">SubCommand.build_lib</span></code></a></li>
<li><a class="reference internal" href="#setuptools.command.build.SubCommand.editable_mode"><code class="docutils literal notranslate"><span class="pre">SubCommand.editable_mode</span></code></a></li>
<li><a class="reference internal" href="#setuptools.command.build.SubCommand.finalize_options"><code class="docutils literal notranslate"><span class="pre">SubCommand.finalize_options()</span></code></a></li>
<li><a class="reference internal" href="#setuptools.command.build.SubCommand.get_output_mapping"><code class="docutils literal notranslate"><span class="pre">SubCommand.get_output_mapping()</span></code></a></li>
<li><a class="reference internal" href="#setuptools.command.build.SubCommand.get_outputs"><code class="docutils literal notranslate"><span class="pre">SubCommand.get_outputs()</span></code></a></li>
<li><a class="reference internal" href="#setuptools.command.build.SubCommand.get_source_files"><code class="docutils literal notranslate"><span class="pre">SubCommand.get_source_files()</span></code></a></li>
<li><a class="reference internal" href="#setuptools.command.build.SubCommand.initialize_options"><code class="docutils literal notranslate"><span class="pre">SubCommand.initialize_options()</span></code></a></li>
<li><a class="reference internal" href="#setuptools.command.build.SubCommand.run"><code class="docutils literal notranslate"><span class="pre">SubCommand.run()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#adding-arguments">Adding Arguments</a></li>
<li><a class="reference internal" href="#customizing-distribution-options">Customizing Distribution Options</a></li>
<li><a class="reference internal" href="#defining-additional-metadata">Defining Additional Metadata</a><ul>
<li><a class="reference internal" href="#adding-new-egg-info-files">Adding new EGG-INFO Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-support-for-revision-control-systems">Adding Support for Revision Control Systems</a></li>
<li><a class="reference internal" href="#final-remarks">Final Remarks</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>


    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=704ab38f"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/js/hoverxref.js"></script>
    <script src="../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../_static/js/micromodal.min.js"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script id="MathJax-script" async="async" src="../_static/js/mathjax/tex-chtml.js"></script>
    </body>
</html>